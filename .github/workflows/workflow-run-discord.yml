name: Notify Discord on main.yml result

on:
  workflow_run:
    workflows: ["main"]
    types:
      - completed

jobs:
  discord-notify:
    # ÏÑ±Í≥µ or Ïã§Ìå®Ïùº ÎïåÎßå Ïã§Ìñâ
    if: |
      github.event.workflow_run.conclusion == 'success' ||
      github.event.workflow_run.conclusion == 'failure'
    runs-on: ubuntu-latest
    steps:
      - name: Notify Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        uses: Ilshidur/action-discord@0c4b27844ba47cb1c7bee539c8eead5284ce9fa9
        with:
          args: |
            üì£ **[{{ EVENT_PAYLOAD.repository.full_name }}] Î∞∞Ìè¨ Í≤∞Í≥º**

            ‚öôÔ∏è Workflow **`{{ EVENT_PAYLOAD.workflow_run.name }}`** Completed
            - Result: 
              {% if EVENT_PAYLOAD.workflow_run.conclusion == 'success' %}Success ‚úÖ{% endif %}
              {% if EVENT_PAYLOAD.workflow_run.conclusion == 'failure' %}Failure ‚ùå{% endif %}
            - Branch: `{{ EVENT_PAYLOAD.workflow_run.head_branch }}`
            - Author: `{{ EVENT_PAYLOAD.workflow_run.head_commit.author.name }}`
            - üîó [View run]({{ EVENT_PAYLOAD.workflow_run.html_url }})
